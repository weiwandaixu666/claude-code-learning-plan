# Day 1 上午 - 3. 代码编辑基础

预计时间：1.5小时

## 📚 学习目标

- [ ] 掌握 Edit 工具的精确编辑
- [ ] 学习使用 Write 工具创建新文件
- [ ] 理解代码编辑的最佳实践
- [ ] 完成实际练习：重构、修复bug、添加功能

## ✏️ 第一步：Edit 工具 - 精确编辑

Edit 工具用于对现有文件进行精确的修改。

### Edit 工作原理

Edit 需要3个关键信息：
1. **file_path**: 要编辑的文件路径
2. **old_string**: 要替换的原文本（必须精确匹配）
3. **new_string**: 新的文本

### 基本用法示例

**简单修改：**

```
请编辑 exercises/sample-code.js
将函数名 "calculateAverage" 改为 "computeAverage"
```

**修改代码块：**

```
编辑 exercises/sample-code.js
将整个 calculateSum 函数的实现改为使用 reduce 方法
```

### 练习 1: 简单修改

```
任务：变量重命名

1. 读取 exercises/sample-code.js
2. 将所有名为 "data" 的变量改为 "inputData"
3. 确保不破坏代码功能
```

### 练习 2: 逻辑修改

```
任务：改进错误处理

在 exercises/sample-code.js 中，
为 add 函数添加参数验证：
- 检查参数是否为数字
- 如果不是数字，返回 NaN
```

## 📝 第二步：Write 工具 - 创建新文件

Write 工具用于创建全新文件或完全覆盖现有文件。

### 重要提示

⚠️ **Write 会覆盖整个文件！** 如果文件已存在，Claude Code 会先使用 Read 工具读取它。

### 创建新文件示例

**创建配置文件：**

```
请在项目根目录创建一个 .gitignore 文件，包含：
node_modules/
.DS_Store
*.log
.env
```

**创建新模块：**

```
创建一个新文件 exercises/math-utils.js
包含以下函数：
- add(a, b)
- subtract(a, b)
- multiply(a, b)
- divide(a, b)
每个函数都要有适当的错误处理
```

### 练习 3: 创建工具模块

```
任务：创建字符串处理工具

创建 exercises/string-utils.js 文件，包含：
1. capitalize(str) - 首字母大写
2. reverse(str) - 反转字符串
3. isPalindrome(str) - 检查回文
4. truncate(str, length) - 截断字符串

为每个函数添加 JSDoc 注释
```

## 🎯 第三步：实际项目练习

### 练习 4: 重构函数

```
任务：代码重构

1. 读取 exercises/refactor-example.ts
2. 识别代码中的重复逻辑
3. 提取公共函数
4. 改进代码可读性
5. 保持原有功能不变

要求：
- 遵循 DRY（Don't Repeat Yourself）原则
- 添加有意义的变量名
- 添加适当的注释
```

### 练习 5: 修复 Bug

```
任务：Bug 修复

1. 读取 exercises/buggy-code.py
2. 分析并找出所有 bug
3. 修复每个 bug
4. 添加测试用例验证修复
5. 添加注释说明问题所在

预期找到的 bug：
- 边界条件处理
- 空值处理
- 逻辑错误
- 类型错误
```

### 练习 6: 添加新功能

```
任务：功能扩展

1. 读取 exercises/sample-code.js
2. 添加以下新功能：
   - median() - 计算中位数
   - mode() - 计算众数
   - variance() - 计算方差
   - standardDeviation() - 计算标准差

要求：
- 复用现有代码
- 保持代码风格一致
- 为新函数添加完整注释
- 处理边界情况
```

## 💡 第四步：编辑最佳实践

### DO's ✅

1. **明确指出修改位置**
   ```
   ✅ "在第 15 行的 if 语句中添加 else 分支"
   ❌ "修改那个 if 语句"
   ```

2. **提供上下文**
   ```
   ✅ "在 calculateSum 函数中，将 for 循环改为使用 reduce 方法"
   ❌ "改成用 reduce"
   ```

3. **保持一致性**
   ```
   ✅ "遵循项目现有的代码风格和命名约定"
   ```

### DON'Ts ❌

1. **不要假设 Claude 知道你的意图**
   ```
   ❌ "修好这个函数"
   ✅ "修复函数中的 null 引用错误"
   ```

2. **不要一次做太多修改**
   ```
   ❌ "重构整个文件并添加新功能"
   ✅ "先重构这个函数，然后我们再添加新功能"
   ```

## 📋 检查点

在继续之前，确保你：

- [ ] 理解 Edit 和 Write 的区别
- [ ] 能够进行精确的代码修改
- [ ] 能够创建包含良好结构的新文件
- [ ] 完成了至少 3 个练习
- [ ] 理解代码编辑的最佳实践

## 🔄 工作流程示例

### 典型的代码修改流程

```
# 步骤 1: 理解现有代码
"请读取 exercises/sample-code.js 并解释其功能"

# 步骤 2: 规划修改
"我想要添加参数验证，应该如何修改？"

# 步骤 3: 执行修改
"请按照我们讨论的方案修改代码"

# 步骤 4: 验证结果
"请再次读取文件，确认修改是否正确"
```

## 🚀 下一步

完成本节后，休息一下，然后继续学习 Day 1 下午课程 [04-bash.md](../afternoon/04-bash.md) - Bash 工具与命令执行。

## 📝 我的笔记

```bash
# 重要技巧和经验
#
#
```

## ⚠️ 常见陷阱

1. **Edit 修改失败**
   - 原因：old_string 不精确匹配
   - 解决：提供更多上下文，确保唯一性

2. **Write 意外覆盖**
   - 原因：忘记 Write 会覆盖整个文件
   - 解决：Claude Code 会自动先用 Read 读取，但你应该确认

3. **破坏代码功能**
   - 原因：修改时没有考虑整体逻辑
   - 解决：修改后让 Claude 检查语法和逻辑

## 🎓 挑战任务

```
挑战：代码审查与改进

1. 让 Claude Code 审查 exercises/refactor-example.ts
2. 列出所有可以改进的地方
3. 按优先级进行改进
4. 对比修改前后的代码
5. 写一份改进总结报告
```
